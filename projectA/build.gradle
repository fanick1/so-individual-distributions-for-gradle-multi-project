
configurations{
	commonProjectContent
}

dependencies{
	// references to artifacts 'sharedContent' in :commonProject
	commonProjectContent project(path: ':commonProject', configuration: 'sharedContent')
}

task copyFromCommonProject(type:Copy, dependsOn: configurations.commonProjectContent){
	from configurations.commonProjectContent.collect{ zipTree(it) }

	into "$buildDir/extracted"
}

// bit of hacking around the structure of the zip file
task syncCommonContent(type:Sync, dependsOn: copyFromCommonProject){
	from "$buildDir/extracted/distro"
	from "$projectDir/src"

	// this folder will contain the content to be packed by distZip task
	into "$buildDir/distAggregate"
}



distributions{
	main{
		contents{
			// the actual content is generated by task syncCommonContent
			from syncCommonContent
		}
	}
}
